#!/usr/bin/env bash
set -euo pipefail

## Bind workspaces 6-10 to the first non-laptop external monitor.
## Runs at startup and on monitor hotplug.

LAPTOP="eDP-1"

# Find the first connected monitor that isn't the laptop
EXTERNAL=$(hyprctl monitors -j | jq -r ".[] | select(.name != \"$LAPTOP\") | .name" | head -n1)

if [[ -z "$EXTERNAL" ]]; then
	exit 0
fi

for ws in 6 7 8 9 10; do
	hyprctl keyword workspace "$ws, monitor:$EXTERNAL, default:true"
done

# Pre-create all workspaces on the external monitor so they exist
# (prevents new workspaces from opening on the focused/laptop monitor)
CURRENT=$(hyprctl activeworkspace -j | jq -r '.id')
for ws in 6 7 8 9 10; do
	hyprctl dispatch workspace "$ws"
done
# Switch back to the original workspace
hyprctl dispatch workspace "$CURRENT"
